-- Creating a  database named  intellipaat
CREATE DATABASE INTELLIPAAT;

--Using the database intellipaat
USE INTELLIPAAT;

-- Creating the table studies
 DROP TABLE IF EXISTS STUDIES;
CREATE TABLE STUDIES(
	PNAME VARCHAR(30),
	INSTITUTE VARCHAR(20),
	COURSE VARCHAR(10),
	COURSE_FEE MONEY);

--Inserting Values into STUDIES TABLES
INSERT INTO STUDIES VALUES('ANAND','SABHARI','PGDCA',4500);
INSERT INTO STUDIES VALUES('ALTAF','COIT','DCA',7200);
INSERT INTO STUDIES VALUES('JULIANA','BDPS','MCA',22000);
INSERT INTO STUDIES VALUES('KAMALA','PRAGATHI','DCA',5000);
INSERT INTO STUDIES VALUES('MARY','SABHARI','PGDCA',4500);
INSERT INTO STUDIES VALUES('NELSON','PRAGATHI','DAP',6200);
INSERT INTO STUDIES VALUES('PATRICK','PRAGATHI','DCAP',5200);
INSERT INTO STUDIES VALUES('QADIR','APPLE','HDCA',14000);
INSERT INTO STUDIES VALUES('RAMESH','SABHARI','PGDCA',4500);
INSERT INTO STUDIES VALUES('REBECCA','BRILLIANT','DCAP',11000);
INSERT INTO STUDIES VALUES('REMITHA','BDPS','DCS',6000);
INSERT INTO STUDIES VALUES('REVATHI','SABHARI','DAP',5000);
INSERT INTO STUDIES VALUES('VIJAYA','BDPA','DCA',48000);

--Creating table SOFTWARE after checking if the table exists in the database

DROP TABLE IF EXISTS SOFTWARE ;

CREATE TABLE SOFTWARE(
	PNAME VARCHAR(30),
	TITLE VARCHAR(30),
	DEVELOPIN VARCHAR(20),
	SCOST MONEY,
	DCOST MONEY,
	SOLD INT);

--Insert Values into SOFTWARE
INSERT INTO SOFTWARE VALUES ('MARY','README','CPP',300,1200,84);
INSERT INTO SOFTWARE VALUES ('ANAND','PARACHUTES','BASIC',399.95,6000,43);
INSERT INTO SOFTWARE VALUES ('ANAND','VIDEO TITLING','PASCAL',7500,16000,9);
INSERT INTO SOFTWARE VALUES ('JULIANA','INVENTORY','COBOL',3000,3500,0);
INSERT INTO SOFTWARE VALUES ('KAMALA','PAYROLL PKG.','DBASE',9000,20000,7);
INSERT INTO SOFTWARE VALUES ('MARY','FINANCIAL ACCT.','ORACLE',18000,85000,4);
INSERT INTO SOFTWARE VALUES ('MARY','CODE GENERATOR','C',4500,20000,23);
INSERT INTO SOFTWARE VALUES ('PATTRICK','README','CPP',300,1200,84);
INSERT INTO SOFTWARE VALUES ('QADIR','BOMB AWAY','ASSEMBLY',750,3000,11);
INSERT INTO SOFTWARE VALUES ('QADIR','VACCINES','C',1900,3100,21);
INSERT INTO SOFTWARE VALUES ('RAMESH','HOTEL MGMT.','DBASE',13000,35000,4);
INSERT INTO SOFTWARE VALUES ('RAMESH','DEAD LEE','PASCAL',599.95,4500,73);
INSERT INTO SOFTWARE VALUES ('REMITHA','PC UTILITIES','C',725,5000,51);
INSERT INTO SOFTWARE VALUES ('REMITHA','TSR HELP PKG.','ASSEMBLY',2500,6000,7);
INSERT INTO SOFTWARE VALUES ('REVATHI','HOSPITAL MGMT.','PASCAL',1100,75000,2);
INSERT INTO SOFTWARE VALUES ('VIJAYA','TSR EDITOR','C',900,700,6);

--cHECKING IF THE TABLE EXISTS AND CREATING THE TABLE PROGRAMMER
DROP TABLE IF EXISTS PROGRAMMER;
CREATE TABLE PROGRAMMER(
	PNAME VARCHAR(30),
	DOB DATE,
	DOJ DATE,
	GENDER VARCHAR(1),
	PROF1 VARCHAR(20),
	PROF2 VARCHAR(20),
	SALARY MONEY);

INSERT INTO PROGRAMMER VALUES ('ANAND','19660412','19920421','M','PASCAL','BASIC',3200);
INSERT INTO PROGRAMMER VALUES ('ALTAF','19640702','19901113','M','CLIPPAER','COBOL',2800);
INSERT INTO PROGRAMMER VALUES ('JULIANA','19600131','19900421','F','COBOL','DBASE',3000);
INSERT INTO PROGRAMMER VALUES ('KAMALA','19681030','19920102','F','C','DBASE',2900);
INSERT INTO PROGRAMMER VALUES ('MARY','19700624','19910201','F','CPP','ORACLE',4500);
INSERT INTO PROGRAMMER VALUES ('NELSON','19850911','19891011','M','COBOL','DBASE',2500);
INSERT INTO PROGRAMMER VALUES ('PATTRICK','19651110','19900421','M','PASCAL','CLIPPER',2800);
INSERT INTO PROGRAMMER VALUES ('QADIR','19650831','19910421','M','ASSEMBLY','C',3000);
INSERT INTO PROGRAMMER VALUES ('RAMESH','19670503','19910223','M','PASCAL','DBASE',3200);
INSERT INTO PROGRAMMER VALUES ('REBECCA','19670101','19901201','F','BASIC','COBOL',2500);
INSERT INTO PROGRAMMER VALUES ('REMITHA','19700419','19930420','F','C','ASSEMBLY',3600);
INSERT INTO PROGRAMMER VALUES ('REVATHI','19691202','19920102','F','PASCAL','BASIC',3700);
INSERT INTO PROGRAMMER VALUES ('VIJAYA','19651214','19920502','F','FOXPRO','C',3500);

--1. Find out the selling cost AVG for packages developed in PASCAL.
SELECT AVG(SCOST) FROM SOFTWARE
WHERE DEVELOPIN='PASCAL';

--2. Display Names, Ages of all Programmers.
SELECT PNAME,DATEDIFF(year,DOB,GETDATE()) AS AGE FROM PROGRAMMER;

--3. Display the Names of those who have done the DAP Course.
SELECT PNAME FROM STUDIES
WHERE COURSE='DAP';

--4. Display the name and Date of Births of all Programmers Born in January.
SELECT PNAME,DOB FROM PROGRAMMER
WHERE DATENAME(month,DOB)='January';

--5. What is the Highest Number of Copies sold by a Package.
SELECT TOP(1) WITH TIES * FROM SOFTWARE
ORDER BY SOLD DESC;

--6. Display the lowest Course Fee.
SELECT TOP(1) WITH TIES * FROM STUDIES
ORDER BY COURSE_FEE;

--7. How many programmers done the PGDCA Course.
SELECT PNAME FROM STUDIES
WHERE COURSE='PGDCA';

--8. How much revenue has been earned through sales of Packages Developed in C.
SELECT SUM(SCOST*SOLD) AS REVENUE FROM SOFTWARE
WHERE DEVELOPIN = 'C';

--9. Display the details of software developed by Ramesh.
SELECT * FROM SOFTWARE 
WHERE PNAME='RAMESH';

--10. How many Programmers studied at Sabhari.
SELECT PNAME, COURSE FROM STUDIES
WHERE INSTITUTE='SABHARI';

--11. Display details of packages whose sales crossed 2000 Mark.
SELECT TITLE,PNAME, DEVELOPIN,SUM(SCOST*SOLD) AS REVENUE FROM SOFTWARE
GROUP BY TITLE,PNAME,DEVELOPIN
HAVING SUM(SCOST*SOLD)>2000;

--12. Display the deatils of packages for which development cost has been recovered.
--13. What is the cost of the costliest software developed in basic.
--14. How many packages are developed in Dbase.
--15. How many programmers studied in Pragathi.
--16. How many programmers paid 5000 to 10000 for their course?
--17. What is the AVG course Fee?
--18. Display the details of programmers knowing C.
--19. Howmany programmers know either COBOL or PASCAL?
--20. How many Programmers dont know PASCAL and C?
--21. How old is the oldest male programmer?
--22. What is the average age of the female  programmer?
--23. Calculate the experience in years for each programmer and display with their names in descending order.
--24. Who are the programmers that celebrate their birthday during the current month
--25. How many female programmers are there?
--26. What are the languages studied by Male programmers?
--27. What is the AVG salary?
--28. How Many people draw salary between 2000 and 4000?
--29. Display the details of those who dont know Clipper, COBOL or PASACAL
--30. Display the Cost of Package developed by each programmer.
--31. Display the sales values of the packages developed by each programmer
--32. Display the number of packages sold by each programmer.
--33. Display the sales cost of the packages developed by each programmer language wise.
--34.
